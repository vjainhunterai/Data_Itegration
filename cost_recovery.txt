SELECT `VENDOR_NAME_ALIAS`, `C1` FROM (SELECT `VENDOR_NAME_ALIAS`, sum(cast(`invSavingsSystem` AS double)) AS `C1` FROM (SELECT `OTBL`.`invSavingsSystem`, `ITBL`.`VENDOR_NAME_ALIAS` FROM (SELECT `OTBL`.`VENDOR_GROUP_KEY`, `OTBL`.`invSavingsSystem` FROM (SELECT `OTBL`.`invCreationDate`, `OTBL`.`invSluType`, `OTBL`.`invSluSystem`, `OTBL`.`invNameCustomer`, `OTBL`.`invCcCode`, `OTBL`.`invSegmentLevel4`, `OTBL`.`invTotPoCount_System`, `OTBL`.`invTotPoAmount_System`, `OTBL`.`invTotInvCount_System`, `OTBL`.`invTotInvAmount_System`, `OTBL`.`invFlagOutlier_System`, `OTBL`.`invDescription_System`, `OTBL`.`invSupplierSluSystem`, `OTBL`.`invMinSystemUnitPriceOfGroup`, `OTBL`.`invMaxSystemUnitPriceOfGroup`, `OTBL`.`invAvgSystemUnitPriceOfGroup`, `OTBL`.`invSavingsSystem`, `OTBL`.`invMinSystemUnitPriceQty`, `OTBL`.`invSystemLatestInvoiceDate`, `OTBL`.`invQtyDerivedSystem`, `OTBL`.`invCodeState_SLUSystem`, `OTBL`.`invSavingsSystem_Range_Current`, `OTBL`.`invSavingsSystem_Range`, `OTBL`.`invSavingsSystem_ByProduct_Range`, `OTBL`.`invMinSystemUnitPriceOfGroup_ByProduct_Range`, `OTBL`.`invMinSystemUnitPriceOfGroup_Range`, `OTBL`.`invSupplierSluSystem_Range`, `OTBL`.`invSystemLatestInvoiceDate_Range`, `OTBL`.`invTotPoCount_System_Range`, `OTBL`.`invTotPoAmount_System_Range`, `OTBL`.`invTotInvCount_System_Range`, `OTBL`.`invTotInvAmount_System_Range`, `OTBL`.`invQtyDerivedSystem_Range`, `OTBL`.`invSluProduct`, `OTBL`.`invTotPoCount_Product`, `OTBL`.`invTotPoAmount_Product`, `OTBL`.`invTotInvCount_Product`, `OTBL`.`invTotInvAmount_Product`, `OTBL`.`invFlagOutlier_Product`, `OTBL`.`invDescription_Product`, `OTBL`.`invSupplierSluProduct`, `OTBL`.`invMinProductUnitPriceOfGroup`, `OTBL`.`invMaxProductUnitPriceOfGroup`, `OTBL`.`invAvgProductUnitPriceOfGroup`, `OTBL`.`invSavingsProduct`, `OTBL`.`invMinProductUnitPriceQty`, `OTBL`.`invProductLatestInvoiceDate`, `OTBL`.`invQtyDerivedProduct`, `OTBL`.`invCodeState_SLUProduct`, `OTBL`.`invSavingsProduct_Range_Current`, `OTBL`.`invSavingsProduct_Range`, `OTBL`.`invMinProductUnitPriceOfGroup_Range`, `OTBL`.`invSupplierSluProduct_Range`, `OTBL`.`invProductLatestInvoiceDate_Range`, `OTBL`.`invTotPoCount_Product_Range`, `OTBL`.`invTotPoAmount_Product_Range`, `OTBL`.`invTotInvCount_Product_Range`, `OTBL`.`invTotInvAmount_Product_Range`, `OTBL`.`invQtyDerivedProduct_Range`, `OTBL`.`invpricVendorNameDedup`, `OTBL`.`invhdrNameMbr`, `OTBL`.`invTransactionCountSystem_Range`, `OTBL`.`invTransactionCountProduct_Range`, `OTBL`.`invTransactionCountSystem`, `OTBL`.`invTransactionCountProduct`, `OTBL`.`active_flag`, `OTBL`.`PARTY_GROUP_KEY`, `OTBL`.`VENDOR_GROUP_KEY`, `OTBL`.`PRD_KEY`, `OTBL`.`MNTH_YEAR`, `OTBL`.`PARTY_KEY`, `ITBL`.`PARTY_GROUP_KEY` AS `C1`, `ITBL`.`PARTY_GROUP_CODE`, `ITBL`.`PARTY_GROUP_NAME`, `ITBL`.`PARTY_GROUP_NAME_ALIAS`, `ITBL`.`EFF_START_DT`, `ITBL`.`EFF_END_DT`, `ITBL`.`CRN_ROW_IND`, `ITBL`.`party_name_hash` FROM (SELECT `invCreationDate`, `invSluType`, `invSluSystem`, `invNameCustomer`, `invCcCode`, `invSegmentLevel4`, `invTotPoCount_System`, `invTotPoAmount_System`, `invTotInvCount_System`, `invTotInvAmount_System`, `invFlagOutlier_System`, `invDescription_System`, `invSupplierSluSystem`, `invMinSystemUnitPriceOfGroup`, `invMaxSystemUnitPriceOfGroup`, `invAvgSystemUnitPriceOfGroup`, `invSavingsSystem`, `invMinSystemUnitPriceQty`, `invSystemLatestInvoiceDate`, `invQtyDerivedSystem`, `invCodeState_SLUSystem`, `invSavingsSystem_Range_Current`, `invSavingsSystem_Range`, `invSavingsSystem_ByProduct_Range`, `invMinSystemUnitPriceOfGroup_ByProduct_Range`, `invMinSystemUnitPriceOfGroup_Range`, `invSupplierSluSystem_Range`, `invSystemLatestInvoiceDate_Range`, `invTotPoCount_System_Range`, `invTotPoAmount_System_Range`, `invTotInvCount_System_Range`, `invTotInvAmount_System_Range`, `invQtyDerivedSystem_Range`, `invSluProduct`, `invTotPoCount_Product`, `invTotPoAmount_Product`, `invTotInvCount_Product`, `invTotInvAmount_Product`, `invFlagOutlier_Product`, `invDescription_Product`, `invSupplierSluProduct`, `invMinProductUnitPriceOfGroup`, `invMaxProductUnitPriceOfGroup`, `invAvgProductUnitPriceOfGroup`, `invSavingsProduct`, `invMinProductUnitPriceQty`, `invProductLatestInvoiceDate`, `invQtyDerivedProduct`, `invCodeState_SLUProduct`, `invSavingsProduct_Range_Current`, `invSavingsProduct_Range`, `invMinProductUnitPriceOfGroup_Range`, `invSupplierSluProduct_Range`, `invProductLatestInvoiceDate_Range`, `invTotPoCount_Product_Range`, `invTotPoAmount_Product_Range`, `invTotInvCount_Product_Range`, `invTotInvAmount_Product_Range`, `invQtyDerivedProduct_Range`, `invpricVendorNameDedup`, `invhdrNameMbr`, `invTransactionCountSystem_Range`, `invTransactionCountProduct_Range`, `invTransactionCountSystem`, `invTransactionCountProduct`, `active_flag`, `PARTY_GROUP_KEY`, `VENDOR_GROUP_KEY`, `PRD_KEY`, `MNTH_YEAR`, `PARTY_KEY` FROM `t0000_test`.`l4_savings_by_system_product` WHERE `invFlagOutlier_System` = 'Standard') AS `OTBL` INNER JOIN (SELECT `PARTY_GROUP_KEY`, `PARTY_GROUP_CODE`, `PARTY_GROUP_NAME`, `PARTY_GROUP_NAME_ALIAS`, `EFF_START_DT`, `EFF_END_DT`, `CRN_ROW_IND`, `party_name_hash` FROM `t0000_test`.`dim_party_group` WHERE `PARTY_GROUP_NAME` = 'DUKE UNIVERSITY HEALTH SYSTEM') AS `ITBL` ON `OTBL`.`PARTY_GROUP_KEY` = `ITBL`.`PARTY_GROUP_KEY`) AS `OTBL` INNER JOIN (SELECT `PRD_KEY`, `PRD_SEGMENT_CODE`, `PRD_SEGMENT`, `PRD_FAMILY_CODE`, `PRD_FAMILY`, `PRD_CLASS_CODE`, `PRD_CLASS`, `PRD_COMMODITY_CODE`, `PRD_COMMODITY`, `PRD_SEGMENT_LEVEL_4`, `EFF_START_DT`, `EFF_END_DT`, `PRD_SEGMENT_LEVEL3`, `PRD_SEGMENT_LEVEL2`, `PRD_SEGMENT_LEVEL1`, `PRD_SEGMENT_LEVEL3_VENDOR`, `PRD_SEGMENT_LEVEL2_VENDOR`, `PRD_SEGMENT_LEVEL1_VENDOR`, `PRD_ITEM_MASTER_COMMODITY`, `PRD_BEST_VAR_COMMODITIES_FLAG`, `PRD_SHI_FLAG`, `PRD_BRAD_FLAG`, `segment_flag`, `product_type` FROM `t0000_test`.`dim_prd` WHERE `product_type` = 'IT') AS `ITBL` ON `OTBL`.`PRD_KEY` = `ITBL`.`PRD_KEY`) AS `OTBL` INNER JOIN (SELECT `VENDOR_GROUP_KEY`, `VENDOR_NAME_ALIAS` FROM (SELECT `VENDOR_GROUP_KEY`, `VENDOR_NAME_ALIAS` FROM `t0000_test`.`dim_vendor` WHERE `VENDOR_NAME_ALIAS` IN ('PEARSON MEDICAL TECHNOLOGIES', 'DUKE TECHNOLOGY CENTER', 'NEWEGG BUSINESS INC', 'LIFE TECHNOLOGIES', 'CDW LLC', 'PRESIDIO NETWORKED SOLUTIONS', 'APPLE INC', 'BEST BUY', 'LENOVO INC', 'DELL')) AS `ITBL` GROUP BY `VENDOR_GROUP_KEY`, `VENDOR_NAME_ALIAS`) AS `ITBL` ON (((`OTBL`.`VENDOR_GROUP_KEY` = `ITBL`.`VENDOR_GROUP_KEY`) AND (`OTBL`.`VENDOR_GROUP_KEY` IS NOT NULL)) AND (`ITBL`.`VENDOR_GROUP_KEY` IS NOT NULL)) OR ((`OTBL`.`VENDOR_GROUP_KEY` IS NULL) AND (`ITBL`.`VENDOR_GROUP_KEY` IS NULL))) AS `ITBL` GROUP BY `VENDOR_NAME_ALIAS`) AS `ITBL` WHERE NOT (`C1` IS NULL) LIMIT 1000001